import{Q as Z,u as he}from"./use-meta-DXtmNCeD.js";import{Q as P}from"./QChip-CooeTkw8.js";import{Q as _e}from"./QBtnToggle-DByOP7dv.js";import{M as ee,r as w,a as y,v as ye,K as we,N as B,O as g,P as m,a6 as i,R as n,T as G,U as v,_ as D,X as z,a0 as H,$ as N,ad as E,a8 as O,a7 as q,S as x,Y as h,ag as K,aB as X,b5 as xe,ac as Y,Q as J}from"./index-CdSTUFLs.js";import{u as Me}from"./use-quasar-Di_hr8PK.js";import{u as te}from"./vue-i18n.runtime-CAvvqPWA.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"row q-gutter-md q-mb-md items-center"},ze=["onClick","onContextmenu"],ke={class:"cell-content"},$e={class:"text-h4 text-weight-bold text-positive q-mb-md"},Se={class:"text-h6 q-mb-sm"},Re={class:"stats-container"},Qe={class:"stat-item"},Ve={class:"stat-label"},qe={class:"stat-value"},Be={class:"stat-item"},Te={class:"stat-label"},Fe={class:"stat-value"},je={class:"text-h4 text-weight-bold text-negative q-mb-md"},De={class:"text-h6 q-mb-sm"},Ne={class:"stats-container"},Ee={class:"stat-item"},Ae={class:"stat-label"},Le={class:"stat-value"},Ue=ee({__name:"MinesweeperGame",setup(se){const _=Me(),{t:p}=te(),u=w([]),f=w("ready"),S=w("medium"),M=w(0),k=w(!1),$=w(!1),T=w(!0);let b=null;const ae={easy:{rows:9,cols:9,mines:10},medium:{rows:16,cols:16,mines:40}},C=y(()=>ae[S.value]),le=y(()=>{const t=u.value.flat().filter(s=>s.isFlagged).length;return C.value.mines-t}),A=y(()=>[{label:"easy",value:"easy"},{label:"medium",value:"medium"}]),ne=y(()=>A.value.find(s=>s.value===S.value)?.label||""),R=y(()=>{const{rows:t,cols:s}=C.value,e=2,r=4,a=3,o=_.screen.width-80,l=_.screen.height-250,c=Math.floor((o-(s-1)*e-r*2-a*2)/s),d=Math.floor((l-(t-1)*e-r*2-a*2)/t),V=Math.min(c,d,30),fe=s*V+(s-1)*e,ge=t*V+(t-1)*e;return{width:`${fe+r*2+a*2}px`,height:`${ge+r*2+a*2}px`,gap:`${e}px`,"--cell-size":`${V}px`}}),oe=y(()=>{const t=R.value["--cell-size"]?.replace("px","")||"30";return{width:`${t}px`,height:`${t}px`,minWidth:`${t}px`,minHeight:`${t}px`}}),L=y(()=>{const t=parseInt(R.value["--cell-size"]?.replace("px","")||"30");return`${Math.max(12,Math.floor(t*.6))}px`}),ie=y(()=>{const t=parseInt(R.value["--cell-size"]?.replace("px","")||"30");return{fontSize:`${Math.max(11,Math.floor(t*.6))}px`}}),U=()=>{const{rows:t,cols:s}=C.value,e=[];for(let r=0;r<t;r++){const a=[];for(let o=0;o<s;o++)a.push({isMine:!1,isRevealed:!1,isFlagged:!1,isExploded:!1,adjacentMines:0});e.push(a)}return e},re=(t,s)=>{const{rows:e,cols:r,mines:a}=C.value;let o=0;for(;o<a;){const l=Math.floor(Math.random()*e),c=Math.floor(Math.random()*r);if(l===t&&c===s||u.value[l]?.[c]?.isMine)continue;const d=u.value[l]?.[c];d&&(d.isMine=!0,o++)}for(let l=0;l<e;l++)for(let c=0;c<r;c++){const d=u.value[l]?.[c];d&&!d.isMine&&(d.adjacentMines=ce(l,c))}},ce=(t,s)=>{let e=0;const{rows:r,cols:a}=C.value;for(let o=-1;o<=1;o++)for(let l=-1;l<=1;l++){if(o===0&&l===0)continue;const c=t+o,d=s+l;c>=0&&c<r&&d>=0&&d<a&&u.value[c]?.[d]?.isMine&&e++}return e},W=(t,s)=>{const{rows:e,cols:r}=C.value,a=u.value[t]?.[s];if(!(!a||a.isRevealed||a.isFlagged)&&(a.isRevealed=!0,a.adjacentMines===0&&!a.isMine))for(let o=-1;o<=1;o++)for(let l=-1;l<=1;l++){if(o===0&&l===0)continue;const c=t+o,d=s+l;c>=0&&c<e&&d>=0&&d<r&&W(c,d)}},de=(t,s)=>{if(f.value==="won"||f.value==="lost")return;const e=u.value[t]?.[s];if(!(!e||e.isRevealed||e.isFlagged)){if(T.value&&(re(t,s),pe(),T.value=!1,f.value="playing"),e.isMine){e.isExploded=!0,f.value="lost",Q(),me(),setTimeout(()=>{$.value=!0},500);return}W(t,s),ve()}},ue=(t,s)=>{if(f.value==="won"||f.value==="lost")return;const e=u.value[t]?.[s];!e||e.isRevealed||(e.isFlagged=!e.isFlagged)},me=()=>{u.value.forEach(t=>{t.forEach(s=>{s.isMine&&(s.isRevealed=!0)})})},ve=()=>{u.value.every(s=>s.every(e=>e.isMine||e.isRevealed))&&(f.value="won",Q(),setTimeout(()=>{k.value=!0},500))},pe=()=>{b&&clearInterval(b),M.value=0,b=setInterval(()=>{M.value++},1e3)},Q=()=>{b&&(clearInterval(b),b=null)},F=t=>{const s=Math.floor(t/60),e=t%60;return`${s}:${e.toString().padStart(2,"0")}`},j=()=>{f.value="ready",T.value=!0,M.value=0,k.value=!1,$.value=!1,Q(),u.value=U()},I=()=>{k.value=!1,$.value=!1,j()};return ye(()=>{u.value=U()}),we(()=>{Q()}),(t,s)=>(g(),B(Z,{class:"flex flex-center column overflow-hidden"},{default:m(()=>[i("div",Ce,[n(P,{icon:"timer",color:"primary","text-color":"white",class:"stat-chip"},{default:m(()=>[G(v(F(M.value)),1)]),_:1}),n(P,{icon:"flag",color:"secondary","text-color":"white",class:"stat-chip"},{default:m(()=>[G(v(le.value),1)]),_:1}),n(_e,{modelValue:S.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>S.value=e),j],push:"",glossy:"","toggle-color":"primary",options:A.value},null,8,["modelValue","options"]),n(D,{label:"restart",color:"negative",icon:"restart_alt",onClick:j})]),i("div",{class:"game-container shadow-3 bg-primary",style:E(R.value)},[(g(!0),z(N,null,H(u.value,(e,r)=>(g(),z("div",{key:`row-${r}`,class:"board-row"},[(g(!0),z(N,null,H(e,(a,o)=>(g(),z("div",{key:`cell-${r}-${o}`,class:Y(["cell",{revealed:a.isRevealed,flagged:a.isFlagged,mine:a.isMine&&(f.value==="lost"||f.value==="won"),exploded:a.isExploded}]),style:E(oe.value),onClick:l=>de(r,o),onContextmenu:xe(l=>ue(r,o),["prevent"])},[i("div",ke,[a.isFlagged&&!a.isRevealed?(g(),B(x,{key:0,name:"flag",color:"red",size:L.value},null,8,["size"])):a.isRevealed?(g(),z(N,{key:1},[a.isMine?(g(),B(x,{key:0,name:"emergency",color:"red-10",size:L.value},null,8,["size"])):a.adjacentMines>0?(g(),z("span",{key:1,class:Y(`number number-${a.adjacentMines}`),style:E(ie.value)},v(a.adjacentMines),7)):J("",!0)],64)):J("",!0)])],46,ze))),128))]))),128))],4),n(X,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=e=>k.value=e),persistent:""},{default:m(()=>[n(O,{class:"victory-card"},{default:m(()=>[n(q,{class:"text-center"},{default:m(()=>[i("div",$e,[n(x,{name:"emoji_events",size:"xl",color:"amber"}),i("div",null,v(h(p)("components.minesweeper.victory.congratulations")),1)]),i("div",Se,v(h(p)("components.minesweeper.victory.gameWin")),1)]),_:1}),n(q,{class:"q-pt-none"},{default:m(()=>[i("div",Re,[i("div",Qe,[n(x,{name:"timer",size:"md",color:"primary"}),i("div",Ve,v(h(p)("components.minesweeper.victory.timeLabel")),1),i("div",qe,v(F(M.value)),1)]),i("div",Be,[n(x,{name:"flag",size:"md",color:"secondary"}),i("div",Te,v(h(p)("components.minesweeper.victory.difficultyLabel")),1),i("div",Fe,v(ne.value),1)])])]),_:1}),n(K,{align:"center"},{default:m(()=>[n(D,{label:h(p)("components.minesweeper.victory.restartButton"),color:"primary",icon:"restart_alt",onClick:I,unelevated:"",class:"q-px-lg"},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(X,{modelValue:$.value,"onUpdate:modelValue":s[2]||(s[2]=e=>$.value=e),persistent:""},{default:m(()=>[n(O,{class:"defeat-card"},{default:m(()=>[n(q,{class:"text-center"},{default:m(()=>[i("div",je,[n(x,{name:"sentiment_very_dissatisfied",size:"xl",color:"red"}),i("div",null,v(h(p)("components.minesweeper.defeat.gameOver")),1)]),i("div",De,v(h(p)("components.minesweeper.defeat.hitMine")),1)]),_:1}),n(q,{class:"q-pt-none"},{default:m(()=>[i("div",Ne,[i("div",Ee,[n(x,{name:"timer",size:"md",color:"primary"}),i("div",Ae,v(h(p)("components.minesweeper.defeat.timeLabel")),1),i("div",Le,v(F(M.value)),1)])])]),_:1}),n(K,{align:"center"},{default:m(()=>[n(D,{label:h(p)("components.minesweeper.defeat.tryAgainButton"),color:"primary",icon:"restart_alt",onClick:I,unelevated:"",class:"q-px-lg"},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),We=be(Ue,[["__scopeId","data-v-6e8168ad"]]),Ye=ee({__name:"MinesweeperPage",setup(se){const{t:_,locale:p}=te();return he(()=>({title:_("pages.minesweeper.title"),meta:{description:{name:"description",content:_("pages.minesweeper.description")},keywords:{name:"keywords",content:_("pages.minesweeper.keywords")},ogTitle:{property:"og:title",content:_("pages.minesweeper.ogTitle")},ogDescription:{property:"og:description",content:_("pages.minesweeper.ogDescription")}},htmlAttr:{lang:p.value}})),(u,f)=>(g(),B(Z,null,{default:m(()=>[n(We)]),_:1}))}});export{Ye as default};
